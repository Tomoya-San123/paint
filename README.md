# 第3回課題 ペイントソフト


## 課題1 (paint1.c)

### 長方形コマンド

- draw_rect()関数を追加した。
```
void draw_rect(Canvas *c, const int x0, const int y0, const int rect_width, const int rect_height);
```
- 内容としては単純で、長方形の各辺にたして盤面内に収まっているかどうかを逐次確認しつつ描画するプログラムを書いた。
- 工夫点としては、対辺の対称性を利用してfor文の回数を2回で済ませたところである。
- interpret_command()内のコマンド解釈プログラムは、LINEの時を参考に変数等を変えただけである。
- History構造体に入れて履歴を残せるようにもした。
- 描画後に "1 rect drawn" が表示される。

---

### 円コマンド

- draw circle()関数を追加した。
```
void draw_circle(Canvas *c, const int x0, const int y0, const int r);
```
- 全体を通して、今塗ろうとしているマスが盤面内かどうかを逐次チェックしている。
- アルゴリズムとしては、右上の4分の1円を描き、残りの部分はその対称性を利用して描画するものである。
- 前のステップで塗ったマスの真上or真左or左上のマスと円の中心との距離を比較し、縁の半径に最も近いマスを塗ることにした。
- 距離の比較は計算量を減らすべく、二乗のままで行っている。
- interpret_command()内のコマンド解釈プログラムは、LINEの時を参考に変数等を変えただけである。
- History構造体に入れて履歴を残せるようにもした。
- 描画後に "1 circle drawn" が表示される。

---

## 課題2 (paint2.c)

- load_file()関数を追加した。
```
Result load_file(const char *filename, History *his, Canvas *c);
```

- 次のようなコマンドを打てば、絵が描画される。
```
load pic.txt
```

- 引数がない状態だと、history.txtから読み込みが行われる。
- ファイルが存在しなかったり、開けなかったりすると、新しく追加したERRFILEというパターンでエラーメッセージが出る。
- テキストファイルを一行ずつ読み取り、それを直接interpret_command()関数に投げることで、ファイル内のコマンドが逐次実行されていく。またこの関数はResult型となっており、コマンドが実行される度にその種類を返してくれるため、その直後に履歴追加をすることが可能になっている。

--- 

## 課題3 (paint3.c)

- change_pen()関数を追加した。
```
void change_pen(const char *new_pen, History *his, Canvas *c) {
    c->pen = *new_pen;
}
```

- 内容は一行で、ペンの種類を変更後のnew_penに変えているだけだ。
- interpret_command()関数内では、引数がなければERRLACKARGSを出し、足りていれば、change_pen()関数に文字を投げるだけである。
- History構造体への追加もpush_command()で行っている。

---

## 課題4 (paint4.c)

### 塗りつぶし

- 二次元の図形を描画する際に、内側を塗りつぶしありにするかなしにするかを選べるようにした。

--- 

### 実行方法(長方形)
```
rect 30 10 50 30 1
```
- 塗りつぶしたい時は、5つ目の引数に1を入れる。
- 塗りつぶさない時は、0を入れる。

### 実行方法(円)
```
circle 40 20 10 1
```
- 長方形の時と同様に最後の引数で0か1を選ぶ。

### 実装方法
- 新たに関数を追加することなく、fillという引数が0か1かによって動作を変えた。
- for文をできる限り少なくするため、長方形や円の対称性を利用した。